{
  "rules": {
    "skipOnRooms": {
      "$roomId": {
        // Allow read/write for users in the room
        // For development: open access (will be restricted in production)
        ".read": true,
        ".write": true,
        
        "users": {
          ".read": true,
          ".write": true
        },
        
        "messages": {
          ".read": true,
          "$messageId": {
            ".write": true,
            // Validate message structure
            ".validate": "newData.hasChildren(['senderId', 'text', 'timestamp']) && newData.child('text').isString() && newData.child('text').val().length > 0 && newData.child('text').val().length <= 500"
          }
        },
        
        "status": {
          ".read": true,
          ".write": true
        },
        
        "createdAt": {
          ".read": true,
          ".write": true
        }
      }
    },
    "watchAlongRooms": {
      "$roomId": {
        // Allow read/write for Watch Along rooms
        // For development: open access (will be restricted in production)
        ".read": true,
        ".write": true,
        
        "messages": {
          ".read": true,
          "$messageId": {
            ".write": true,
            // Validate message structure
            ".validate": "newData.hasChildren(['senderId', 'text', 'timestamp']) && newData.child('text').isString() && newData.child('text').val().length > 0 && newData.child('text').val().length <= 500"
          }
        }
      }
    }
  }
}

